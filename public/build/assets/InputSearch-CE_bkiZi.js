import{d as z,ar as H,E as K,p as g,C as w,ay as _,aA as F,x as I,q as U,K as $,e as p,o as f,k as A,f as d,h as M,N as D,M as O,P as R,u as E,n as N,L as j,al as G,F as J,r as Q,aB as W}from"./app-CyHHzooV.js";import{d as X}from"./debounce-DSqrr82O.js";const Y={key:0,class:"input-label inline-block mb-1 font-semibold"},Z={class:"input-field-wrap relative"},ee=["onKeydown","onClick"],te=["innerHTML"],ae={key:1,class:"input-alert"},ne=z({__name:"InputSearch",props:{wrap:{type:String},class:{type:String},skip:{type:Array,default:()=>[]},set:{type:String,required:!0},loc:{type:String,required:!0},labelOn:{type:Boolean,default:!0},alerts:{type:Array},label:{type:String,default:s=>H.startCase(s.loc.split(".").pop())},format:{type:Function,default:s=>s.name}},setup(s){const r=s,h=K(),i=g(""),n=g(!1),u=g([]),y=g(null),c=w({get:()=>{const t=_(h.state,r.loc,null);return t===null?t:r.format(t)},set:t=>{h.commit(r.set,{value:t,loc:v.value})}}),q=w(()=>c.value===null),v=w(()=>`${r.loc.split(".").pop()}`),k=w(()=>`${F(v.value)}_index`),B=()=>{i.value="",c.value=null,u.value=[],n.value=!1},x=async(t="")=>{const e=new W,o={query:t,page:1,perPage:32,indexName:k.value},{data:a}=await e.search(o),l=a.filter(b=>!r.skip.includes(b.id));if(console.log({filteredData:l,skip:r.skip}),u.value=l,!u.value.length){const b={query:"",page:1,perPage:32,indexName:k.value},V=await e.search(b);u.value=V.data}},S=X(()=>{x(i.value),n.value=!0},500),C=()=>{u.value.length||x(),n.value=!n.value},m=(t,e)=>{if(!e)return;const o=Array.from(e.children);let a;if(t==="first")a=o[0];else if(t==="last")a=o[o.length-1];else if(t==="next"){let l=e.nextElementSibling;for(;l&&!(l instanceof HTMLElement);)l=l.nextElementSibling;a=l}else if(t==="prev"){let l=e.previousElementSibling;for(;l&&!(l instanceof HTMLElement);)l=l.previousElementSibling;a=l}a&&(a.focus(),a.scrollIntoView({behavior:"smooth",block:"nearest"}))},P=(t,e)=>{e&&(n.value||C(),t.key==="ArrowDown"&&m("first",e),t.key==="ArrowUp"&&m("last",e))},T=(t,e)=>{switch(e.key){case"ArrowDown":m("next",e.target);break;case"ArrowUp":m("prev",e.target);break;case"Enter":L(t)}},L=t=>{c.value=t,n.value=!1};return I(c,()=>{i.value=c.value}),U(()=>{i.value=c.value}),(t,e)=>{const o=$("base-button");return f(),p("div",{class:N(["input-search-wrap",s.wrap])},[s.labelOn?(f(),p("label",Y,M(s.label),1)):A("",!0),d("div",Z,[D(d("input",{"onUpdate:modelValue":e[0]||(e[0]=a=>i.value=a),class:N(["input-field",s.class]),onInput:e[1]||(e[1]=(...a)=>E(S)&&E(S)(...a)),onKeydown:e[2]||(e[2]=a=>P(a,y.value)),onClick:C},null,34),[[R,i.value]]),O(o,{class:"btn-action bg-sky-600 text-white",onClick:B},{default:j(()=>e[3]||(e[3]=[d("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24"},[d("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"1.5",d:"M6.758 17.243L12.001 12m5.243-5.243L12 12m0 0L6.758 6.757M12.001 12l5.243 5.243"})],-1)])),_:1,__:[3]}),D(d("ul",{ref_key:"resultsList",ref:y,class:"search-results absolute border bg-neutral-400 w-full top-[102%] z-20 max-h-64 overflow-auto"},[(f(!0),p(J,null,Q(u.value,a=>(f(),p("li",{key:a.id,tabindex:"-1",class:"result px-4 py-3 text-white hover:bg-zinc-500 cursor-pointer",onKeydown:l=>T(a,l),onClick:l=>L(a)},[d("span",{innerHTML:s.format(a)},null,8,te)],40,ee))),128))],512),[[G,n.value]])]),s.alerts.includes(v.value)&&q.value?(f(),p("div",ae,M(v.value)+" field is required ",1)):A("",!0)],2)}}});export{ne as default};
