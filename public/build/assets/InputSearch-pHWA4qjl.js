import{d as P,ar as T,C as V,p as g,D as w,x as F,q as I,E as K,o as d,e as p,h as L,j as A,f as c,H as M,J as U,n as D,u as E,L as $,G as j,al as O,F as R,r as _,az as G,aA as J,aB as Q}from"./app-Cn69L5Cc.js";import{d as W}from"./debounce-wq_hELgV.js";const X={key:0,class:"input-label inline-block mb-1 font-semibold"},Y={class:"input-field-wrap relative"},Z=["onKeydown","onClick"],ee=["innerHTML"],te={key:1,class:"input-alert"},se=P({__name:"InputSearch",props:{wrap:{type:String},class:{type:String},set:{type:String,required:!0},loc:{type:String,required:!0},labelOn:{type:Boolean,default:!0},alerts:{type:Array},label:{type:String,default:s=>T.startCase(s.loc.split(".").pop())},format:{type:Function,default:s=>s.name}},setup(s){const v=s,b=V(),r=g(""),n=g(!1),i=g([]),h=g(null),u=w({get:()=>{const t=G(b.state,v.loc,null);return t===null?t:v.format(t)},set:t=>{b.commit(v.set,{value:t,loc:f.value})}}),q=w(()=>u.value===null),f=w(()=>`${v.loc.split(".").pop()}`),y=w(()=>`${J(f.value)}_index`),B=()=>{r.value="",u.value=null,i.value=[],n.value=!1},k=async(t="")=>{const e=new Q,o={query:t,page:1,perPage:32,indexName:y.value},{data:a}=await e.search(o);if(i.value=a,!i.value.length){const l={query:"",page:1,perPage:32,indexName:y.value},H=await e.search(l);i.value=H.data}},x=W(()=>{k(r.value),n.value=!0},500),S=()=>{i.value.length||k(),n.value=!n.value},m=(t,e)=>{if(!e)return;const o=Array.from(e.children);let a;if(t==="first")a=o[0];else if(t==="last")a=o[o.length-1];else if(t==="next"){let l=e.nextElementSibling;for(;l&&!(l instanceof HTMLElement);)l=l.nextElementSibling;a=l}else if(t==="prev"){let l=e.previousElementSibling;for(;l&&!(l instanceof HTMLElement);)l=l.previousElementSibling;a=l}a&&(a.focus(),a.scrollIntoView({behavior:"smooth",block:"nearest"}))},N=(t,e)=>{e&&(n.value||S(),t.key==="ArrowDown"&&m("first",e),t.key==="ArrowUp"&&m("last",e))},z=(t,e)=>{switch(e.key){case"ArrowDown":m("next",e.target);break;case"ArrowUp":m("prev",e.target);break;case"Enter":C(t)}},C=t=>{u.value=t,n.value=!1};return F(u,()=>{r.value=u.value}),I(()=>{r.value=u.value}),(t,e)=>{const o=K("base-button");return d(),p("div",{class:D(["input-search-wrap",s.wrap])},[s.labelOn?(d(),p("label",X,L(s.label),1)):A("",!0),c("div",Y,[M(c("input",{"onUpdate:modelValue":e[0]||(e[0]=a=>r.value=a),class:D(["input-field",s.class]),onInput:e[1]||(e[1]=(...a)=>E(x)&&E(x)(...a)),onKeydown:e[2]||(e[2]=a=>N(a,h.value)),onClick:S},null,34),[[U,r.value]]),$(o,{class:"btn-action bg-sky-600 text-white",onClick:B},{default:j(()=>e[3]||(e[3]=[c("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24"},[c("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"1.5",d:"M6.758 17.243L12.001 12m5.243-5.243L12 12m0 0L6.758 6.757M12.001 12l5.243 5.243"})],-1)])),_:1}),M(c("ul",{ref_key:"resultsList",ref:h,class:"search-results absolute border bg-neutral-400 w-full top-[102%] z-20 max-h-64 overflow-auto"},[(d(!0),p(R,null,_(i.value,a=>(d(),p("li",{key:a.id,tabindex:"-1",class:"result px-4 py-3 text-white hover:bg-zinc-500 cursor-pointer",onKeydown:l=>z(a,l),onClick:l=>C(a)},[c("span",{innerHTML:s.format(a)},null,8,ee)],40,Z))),128))],512),[[O,n.value]])]),s.alerts.includes(f.value)&&q.value?(d(),p("div",te,L(f.value)+" field is required ",1)):A("",!0)],2)}}});export{se as default};
