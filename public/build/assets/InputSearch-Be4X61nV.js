import{d as V,ar as z,E as H,p as g,C as w,ay as K,aA as _,x as F,q as I,K as U,e as d,o as p,k as L,f as c,h as A,N as M,M as $,P as O,u as E,n as N,L as R,al as j,F as G,r as J,aB as Q}from"./app-BbdjgHJc.js";import{d as W}from"./debounce-DjkR9LS2.js";const X={key:0,class:"input-label inline-block mb-1 font-semibold"},Y={class:"input-field-wrap relative"},Z=["onKeydown","onClick"],ee=["innerHTML"],te={key:1,class:"input-alert"},se=V({__name:"InputSearch",props:{wrap:{type:String},class:{type:String},set:{type:String,required:!0},loc:{type:String,required:!0},labelOn:{type:Boolean,default:!0},alerts:{type:Array},label:{type:String,default:s=>z.startCase(s.loc.split(".").pop())},format:{type:Function,default:s=>s.name}},setup(s){const v=s,b=H(),r=g(""),n=g(!1),i=g([]),h=g(null),u=w({get:()=>{const t=K(b.state,v.loc,null);return t===null?t:v.format(t)},set:t=>{b.commit(v.set,{value:t,loc:f.value})}}),q=w(()=>u.value===null),f=w(()=>`${v.loc.split(".").pop()}`),y=w(()=>`${_(f.value)}_index`),B=()=>{r.value="",u.value=null,i.value=[],n.value=!1},k=async(t="")=>{const e=new Q,o={query:t,page:1,perPage:32,indexName:y.value},{data:a}=await e.search(o);if(i.value=a,!i.value.length){const l={query:"",page:1,perPage:32,indexName:y.value},T=await e.search(l);i.value=T.data}},x=W(()=>{k(r.value),n.value=!0},500),S=()=>{i.value.length||k(),n.value=!n.value},m=(t,e)=>{if(!e)return;const o=Array.from(e.children);let a;if(t==="first")a=o[0];else if(t==="last")a=o[o.length-1];else if(t==="next"){let l=e.nextElementSibling;for(;l&&!(l instanceof HTMLElement);)l=l.nextElementSibling;a=l}else if(t==="prev"){let l=e.previousElementSibling;for(;l&&!(l instanceof HTMLElement);)l=l.previousElementSibling;a=l}a&&(a.focus(),a.scrollIntoView({behavior:"smooth",block:"nearest"}))},D=(t,e)=>{e&&(n.value||S(),t.key==="ArrowDown"&&m("first",e),t.key==="ArrowUp"&&m("last",e))},P=(t,e)=>{switch(e.key){case"ArrowDown":m("next",e.target);break;case"ArrowUp":m("prev",e.target);break;case"Enter":C(t)}},C=t=>{u.value=t,n.value=!1};return F(u,()=>{r.value=u.value}),I(()=>{r.value=u.value}),(t,e)=>{const o=U("base-button");return p(),d("div",{class:N(["input-search-wrap",s.wrap])},[s.labelOn?(p(),d("label",X,A(s.label),1)):L("",!0),c("div",Y,[M(c("input",{"onUpdate:modelValue":e[0]||(e[0]=a=>r.value=a),class:N(["input-field",s.class]),onInput:e[1]||(e[1]=(...a)=>E(x)&&E(x)(...a)),onKeydown:e[2]||(e[2]=a=>D(a,h.value)),onClick:S},null,34),[[O,r.value]]),$(o,{class:"btn-action bg-sky-600 text-white",onClick:B},{default:R(()=>e[3]||(e[3]=[c("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24"},[c("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"1.5",d:"M6.758 17.243L12.001 12m5.243-5.243L12 12m0 0L6.758 6.757M12.001 12l5.243 5.243"})],-1)])),_:1,__:[3]}),M(c("ul",{ref_key:"resultsList",ref:h,class:"search-results absolute border bg-neutral-400 w-full top-[102%] z-20 max-h-64 overflow-auto"},[(p(!0),d(G,null,J(i.value,a=>(p(),d("li",{key:a.id,tabindex:"-1",class:"result px-4 py-3 text-white hover:bg-zinc-500 cursor-pointer",onKeydown:l=>P(a,l),onClick:l=>C(a)},[c("span",{innerHTML:s.format(a)},null,8,ee)],40,Z))),128))],512),[[j,n.value]])]),s.alerts.includes(f.value)&&q.value?(p(),d("div",te,A(f.value)+" field is required ",1)):L("",!0)],2)}}});export{se as default};
