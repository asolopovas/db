import{d as ue,C as v,p as D,e as w,B as I,k as A,f as l,M,K as k,n as U,F as B,r as W,an as ce,u as h,E as ie,o as n,T as he,ao as fe,x as ae,L as C,i as q,h as X,s as se,N as we,Q as xe,j as _e,ap as Ve}from"./app-CZIMIw-m.js";import{A as oe,S as le,E as Ce}from"./save-DpFoz-B6.js";import{u as ke}from"./indexView-CmbVWeMO.js";const Ne={height:"390px",className:"grid md:grid-cols-2 gap-2",columns:{id:["id"],name:["name"],vat_number:["vat_number"],bank:["bank"],account_number:["account_nr"],sort_code:["sort_code"]},fields:{name:{type:"text"},telephone1:{type:"tel",hide:!0},telephone2:{type:"tel",hide:!0},web:{type:"text",hide:!0},email:{type:"email"},vat_number:{type:"text"},bank:{type:"text"},sort_code:{type:"text"},account_nr:{type:"text"},address:{type:"textarea",height:"100px"},notes:{type:"textarea"}}},Se={fields:{email2:{type:"email"},email3:{type:"email"},phone:{type:"tel"},mobile_phone:{type:"tel"},home_phone:{type:"tel"},work_phone:{type:"tel"},fax:{type:"tel"}}},ne=`<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><g fill="none" stroke="currentColor"><rect width="14" height="17" x="5" y="4" rx="2"/><path stroke-linecap="round" d="M9 9h6m-6 4h6m-6 4h4"/></g></svg>
`,Oe={className:"w-[500px] max-w-full",tabs:{general:!0,address:!1,extras:!1},sort:{address:"postcode",name:"lastname"},columns:{id:["id"],name:["title","firstname","lastname"],address:["address_line_1","town","county","city"],postcode:["postcode"]},groups:[{name:"general",className:"grid md:grid-cols-2 gap-3 w-full",id:{type:"number",edit:!1,hide:!0},title:{type:"select",options:["Mr.","Mrs.","Miss","Dr."]},firstname:{type:"text",className:"w-[140px]"},lastname:{type:"text"},phone:{type:"tel",autocomplete:"off"},mobile_phone:{type:"tel"},home_phone:{type:"tel"},work_phone:{type:"tel"},email1:{type:"email"},email2:{type:"email"},email3:{type:"email"}},{name:"address",className:"grid grid-cols-2 gap-2",address_line_1:{type:"text"},address_line_2:{type:"text"},region:{type:"text"},town:{type:"text"},county:{type:"text"},city:{type:"text"},postcode:{type:"text"},country:{type:"text",default:"United Kingdom"},fax:{type:"tel"}},{name:"extras",className:"",company:{type:"text"},web_page:{type:"text"},status:{type:"select",options:["ACTIVE","ARCHIVED"]},note:{type:"textarea",height:"140px"}},{name:"timestamps",className:"",created_at:{type:"timestamp",readonly:!0},updated_at:{type:"timestamp",readonly:!0}}],buttonsWrapper:"flex justify-end gap-2",buttons:{view:[{class:"btn-action bg-emerald-600 hover:bg-emerald-700 text-white",label:"Edit",action:"edit",icon:Ce},{class:"btn-action bg-blue-500 text-white hover:bg-blue-400",label:"Orders",action:"viewOrders",icon:ne}],edit:[{class:"btn-action bg-blue-500 text-white hover:bg-blue-400",label:"Orders",action:"viewOrders",icon:ne},{class:"btn-action bg-emerald-600 hover:bg-emerald-700 text-white",label:"New Order",action:"newOrder",icon:oe},{class:"btn-action bg-yellow-500  text-gray-800 hover:bg-yellow-400 hover:text-gray-700",label:"Save",action:"save",icon:le}],add:[{class:"btn-action bg-emerald-600 hover:bg-emerald-700 text-white",label:"Add",action:"add",icon:oe},{class:"btn-action bg-rose-500 hover:bg-rose-600 text-white",label:"Cancel",action:"cancel",icon:le}]}},Ie={fields:{width:{type:"text",format:""},thickness:{type:"number"},length:{type:"number"},type:{type:"select",options:["Plank","Chevron","Herringbone","Versailles Panel","Mansion Weave"],filters:["startCase"]},price:{type:"number"}}},Ae={fields:{note:{type:"textarea"},web_page:{type:"text"},company:{type:"text"},grand_design:{type:"checkbox"}}},$e={fields:{street:{type:"text"},town:{type:"text"},county:{type:"text"},city:{type:"text"},postcode:{type:"text"},country:{type:"text"}}},F={fields:{name:{type:"text"},price:{type:"number"}}},De={fields:{name:{type:"text"},value:{type:"text"}}},je={className:"grid md:grid-cols-2 gap-3",columns:{id:["id"],name:["username"],role:["role.name"]},fields:{name:{type:"text"},username:{type:"text"},title:{type:"text"},email:{type:"text"},role:{type:"select",options:["admin","user"]},phone:{type:"text"},password:{type:"password"},mobile:{type:"text"},created_at:{type:"text",hide:!0},updated_at:{type:"text",hide:!0}}},Me={fields:{name:{type:"text"},sku:{type:"text"},price:{type:"number"}}},ee={fields:{name:{type:"text"}}},Be={areas:{...ee},companies:Ne,contacts:Se,customers:Oe,dimensions:Ie,extras:F,floors:Me,grades:F,materials:{...F,measurement_unit:{type:"text"}},notes:Ae,projects:$e,services:{...F,measurement_unit:{type:"text"}},settings:De,statuses:{...ee},users:je},Te=R=>Be[R]||ee,re=ue({__name:"Item",props:{modelValue:{default:()=>({})},structure:{default:()=>({})},routeName:{default:""},mode:{default:"add"},class:{},enableTabs:{type:Boolean,default:!1}},emits:["update:modelValue","add","save","cancel","newOrder","viewOrders","update:tabs"],setup(R,{emit:g}){const d=g,p=ie(),s=R,N=v(()=>!!s.structure.groups),z=Object.freeze({ADMIN:1,USER:2}),K=o=>{var y;if(o==="role")return((y=s.modelValue.role)==null?void 0:y.name)??"";const m=s.modelValue[o];return m!=null?String(m):""},S=(o,m,y)=>{if(m==="role"){const V=z[o.toString().toUpperCase()];if(V!==void 0){s.modelValue.role_id=V;const $=p.state.auth.roles.find(i=>i.id===V);s.modelValue.role=$,d("update:modelValue",s.modelValue);return}console.warn(`Invalid role: ${o}`);return}s.modelValue[m]=y.type==="number"?Number(o):o,d("update:modelValue",s.modelValue)},r=v(()=>s.structure),c=D({...r.value.tabs}),x=D(Object.keys(c.value).find(o=>c.value[o])),T=r.value.buttons??void 0,u=r.value.buttonsWrapper??"",_=v(()=>{if(!N.value)return{fields:r.value.fields,className:""};const o=r.value.groups.find($=>$.name===x.value),{name:m,className:y,...V}=o;return{fields:V,className:y}}),f=v(()=>N.value?_.value.className:r.value.className),P=o=>{r.value.tabs[o]=!0},G=()=>d("cancel"),H=()=>d("add",s.modelValue),Q=()=>d("save",s.modelValue),Y=()=>d("newOrder",s.modelValue),E=()=>d("viewOrders",s.modelValue);return(o,m)=>{const y=k("active-tabs"),V=k("edit-row"),$=k("action-buttons");return n(),w(B,null,[o.enableTabs&&r.value.tabs?(n(),I(y,{key:0,"onUpdate:active":m[0]||(m[0]=i=>x.value=i),tabs:c.value,"onUpdate:tabs":m[1]||(m[1]=i=>P(i))},null,8,["tabs"])):A("",!0),l("div",{class:"fields-wrap overflow-auto my-4",style:ce({height:r.value.height})},[l("div",{class:U(f.value)},[(n(!0),w(B,null,W(_.value.fields,(i,j)=>(n(),w(B,{key:j},[i.hide?A("",!0):(n(),I(V,{key:0,class:U(i.class),modelValue:K(j),"onUpdate:modelValue":Z=>S(Z,j,i),height:i.height,label:j,"label-on":!0,type:i.type,edit:!0,params:i},null,8,["class","modelValue","onUpdate:modelValue","height","label","type","params"]))],64))),128))],2)],4),M($,{mode:o.mode,buttons:h(T),class:U(h(u)),onNewOrder:Y,onViewOrders:E,onAdd:H,onSave:Q,onCancel:G},null,8,["mode","buttons","class"])],64)}}}),Ee={class:"table-wrap"},Ue={class:"px-4 overflow-auto w-full"},Re={class:"bg-white"},He={scope:"col",class:"t-col w-12 text-center align-middle"},Le={class:"w-full h-full flex justify-center items-center"},qe=["checked"],Fe=["onClick"],We={class:"t-col w-12 h-12"},ze={class:"w-full h-full flex justify-center items-center"},Ke=["value"],Pe=["data-label","innerHTML"],Ge={class:"t-col t-col-action content-center","data-label":"Action"},Qe={key:0},Ye=["colspan"],et=ue({__name:"Items",setup(R){const g=ie(),d=Ve(),p=he(),{showNewItemModal:s,edit:N,pageSwitch:z,fetchData:K}=ke(),S=D(!1),r=v(()=>g.state.items[p.name].items),c=D({}),x=D({}),T=D({}),u=D([]),_=v(()=>g.state.pagination),f=v(()=>Te(p.name)),P=v(()=>f.value.buttons),G=v(()=>Object.entries(T.value).map(([t,e])=>`${t},${e}`).join(";")),H=v(()=>f.value.columns),Q=v(()=>{const t=f.value.columns;return t?r.value.map(O=>fe(O,t)):r.value}),Y=t=>{var L;const e=((L=f.value.sort)==null?void 0:L[t])??t,O=T.value[e]||"asc";T.value={[e]:O==="asc"?"desc":"asc"}},E=v(()=>H.value?Object.keys(H.value):Object.keys(f.value.fields)),o=v(()=>r.value.length>0&&u.value.length===r.value.length),m=()=>{y(),s.value=!0},y=()=>{c.value={},x.value={},u.value=[]},V=()=>{o.value?u.value=[]:u.value=r.value.map(t=>t.id)},$=()=>{S.value=!0},i=(t,e)=>e==="measurement_unit"?t.measurement_unit:e==="price"?_e(t.price):t[e],j=t=>{u.value=[],c.value={...t},x.value={...t},S.value=!0},Z=async()=>{if(u.value.length>0)for(const t of u.value)await g.dispatch("deleteItemAction",{id:t,routeName:p.name});else await g.dispatch("deleteItemAction",{id:c.value.id,routeName:p.name});S.value=!1,y()},de=async()=>{await g.dispatch("createItemAction",{item:c.value,routeName:p.name}),c.value={},s.value=!1},pe=t=>{N.value=!0;const e=r.value.find(O=>O.id===Number(t));c.value={...e},x.value={...e}},me=async()=>{await g.dispatch("updateItemAction",{item:c.value,itemClone:x.value,routeName:p.name}),N.value=!1,y()},te=t=>{d.push({name:"orders",query:{filters:{customer:t.id}}})},ve=async()=>{const{data:t}=await g.dispatch("orderCreate",{customer_id:c.value.id});d.push({name:"orderDetails",params:{id:t.id}})};return ae(G,t=>{const e={...p.query,orderBy:t||void 0};p.query.orderBy===t?d.replace({query:{...e,_ts:Date.now()}}):d.replace({query:e})}),ae(p,()=>{K()},{immediate:!0}),(t,e)=>{const O=k("base-button"),L=k("items-options"),J=k("modal"),ye=k("action-buttons"),be=k("pagination"),ge=k("main-layout");return n(),I(ge,null,{options:C(()=>[u.value.length?(n(),I(O,{key:0,class:"btn-action bg-red-600 hover:bg-red-700 text-white mr-2",onClick:$},{default:C(()=>[q(" Delete Selected ("+X(u.value.length)+") ",1)]),_:1})):A("",!0),M(O,{class:"btn-action bg-emerald-600 hover:bg-emerald-700 text-white",onClick:m},{default:C(()=>e[9]||(e[9]=[l("svg",{xmlns:"http://www.w3.org/2000/svg",width:"18",height:"18",viewBox:"0 0 24 24"},[l("path",{fill:"currentColor",d:"M13 4v7h7v2h-7v7h-2v-7H4v-2h7V4h2Z"})],-1)])),_:1,__:[9]}),M(L)]),default:C(()=>[S.value?(n(),I(J,{key:0,controls:!0,class:"send",onClose:e[0]||(e[0]=a=>S.value=!1),onNo:e[1]||(e[1]=a=>S.value=!1),onYes:Z},{default:C(()=>[q(X(u.value.length>0?`Do you wish to delete ${u.value.length} selected items?`:"Do you wish to delete this item?"),1)]),_:1})):A("",!0),h(s)?(n(),I(J,{key:1,onClose:e[4]||(e[4]=a=>s.value=!1)},{title:C(()=>e[10]||(e[10]=[q("Add Item",-1)])),default:C(()=>[M(re,{modelValue:c.value,"onUpdate:modelValue":e[2]||(e[2]=a=>c.value=a),mode:"add",routeName:h(p).name,structure:f.value,enableTabs:!0,onAdd:de,onCancel:e[3]||(e[3]=a=>s.value=!1)},null,8,["modelValue","routeName","structure"])]),_:1})):A("",!0),h(N)?(n(),I(J,{key:2,onClose:e[7]||(e[7]=a=>N.value=!1),style:ce({height:f.value.modalMinHeight})},{title:C(()=>e[11]||(e[11]=[q("Edit Item",-1)])),default:C(()=>[M(re,{mode:"edit",modelValue:x.value,"onUpdate:modelValue":e[5]||(e[5]=a=>x.value=a),routeName:h(p).name,structure:f.value,enableTabs:!0,onNewOrder:ve,onViewOrders:te,onSave:me,onCancel:e[6]||(e[6]=a=>N.value=!1)},null,8,["modelValue","routeName","structure"])]),_:1},8,["style"])):A("",!0),l("div",Ee,[l("div",Ue,[l("table",null,[l("thead",null,[l("tr",Re,[l("th",He,[l("div",Le,[l("input",{name:"select-all",type:"checkbox",checked:o.value,onChange:V,class:"rounded h-5 w-5"},null,40,qe)])]),(n(!0),w(B,null,W(E.value,a=>(n(),w("th",{key:a,scope:"col",class:U(`t-col t-col-${a.toLowerCase()}`),onClick:b=>Y(a)},X(h(se)(a)),11,Fe))),128)),e[12]||(e[12]=l("th",{scope:"col",class:"t-col t-col-action w-[200px]"}," Action ",-1))])]),l("tbody",null,[(n(!0),w(B,null,W(Q.value,a=>(n(),w("tr",{key:a.id},[l("td",We,[l("div",ze,[we(l("input",{name:"select-item",class:"rounded h-5 w-5",type:"checkbox",value:a.id,"onUpdate:modelValue":e[8]||(e[8]=b=>u.value=b)},null,8,Ke),[[xe,u.value]])])]),(n(!0),w(B,null,W(E.value,b=>(n(),w("td",{class:U(["t-col",`t-col-${b.toLowerCase()}`]),"data-label":h(se)(b),key:b,innerHTML:i(a,b)},null,10,Pe))),128)),l("td",Ge,[M(ye,{buttons:P.value,mode:"view",onEdit:b=>pe(a.id),onRemove:b=>j(a),onViewOrders:b=>te(a),onOrderCreate:async()=>{const{data:b}=await h(g).dispatch("orderCreate",{customer_id:a.id});h(d).push({name:"orderDetails",params:{id:b.id}})},class:"flex justify-end gap-2"},null,8,["buttons","onEdit","onRemove","onViewOrders","onOrderCreate"])])]))),128)),r.value.length?A("",!0):(n(),w("tr",Qe,[l("td",{colspan:E.value.length+2,class:"text-center text-capitalize text-uppercase font-bold"}," Sorry No Records Found ",8,Ye)]))])]),_.value.last_page&&_.value.current_page?(n(),I(be,{key:_.value.current_page+"-"+_.value.last_page,class:"w-full justify-end py-2 bg-neutral-100 border-t-2","click-handler":h(z),"per-slice":5,"current-page":_.value.current_page,"last-page":_.value.last_page},null,8,["click-handler","current-page","last-page"])):A("",!0)])])]),_:1})}}});export{et as default};
