import{d as le,C as re,D as m,p as D,E as _,o as n,e as x,B as I,j as A,f as c,n as E,F as M,r as W,an as ue,L as j,u as y,ao as me,T as ve,x as ee,G as N,i as Q,h as ye,s as te,k as be,ap as ge}from"./app-Cn69L5Cc.js";import{E as fe,A as ae,S as se}from"./save-DpFoz-B6.js";import{u as xe}from"./indexView-Co3lSGa8.js";const he={height:"390px",className:"grid md:grid-cols-2 gap-2",columns:{id:["id"],name:["name"],vat_number:["vat_number"],bank:["bank"],account_number:["account_nr"],sort_code:["sort_code"]},fields:{name:{type:"text"},telephone1:{type:"tel",hide:!0},telephone2:{type:"tel",hide:!0},web:{type:"text",hide:!0},email:{type:"email"},vat_number:{type:"text"},bank:{type:"text"},sort_code:{type:"text"},account_nr:{type:"text"},address:{type:"textarea",height:"100px"},notes:{type:"textarea"}}},we={fields:{email2:{type:"email"},email3:{type:"email"},phone:{type:"tel"},mobile_phone:{type:"tel"},home_phone:{type:"tel"},work_phone:{type:"tel"},fax:{type:"tel"}}},oe=`<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><g fill="none" stroke="currentColor"><rect width="14" height="17" x="5" y="4" rx="2"/><path stroke-linecap="round" d="M9 9h6m-6 4h6m-6 4h4"/></g></svg>
`,_e={className:"w-[500px] max-w-full",tabs:{general:!0,address:!1,extras:!1},sort:{address:"postcode",name:"lastname"},columns:{id:["id"],name:["title","firstname","lastname"],address:["address_line_1","town","county","city"],postcode:["postcode"]},groups:[{name:"general",className:"grid md:grid-cols-2 gap-3 w-full",id:{type:"number",edit:!1,hide:!0},title:{type:"select",options:["Mr.","Mrs.","Miss","Dr."]},firstname:{type:"text",className:"w-[140px]"},lastname:{type:"text"},phone:{type:"tel",autocomplete:"off"},mobile_phone:{type:"tel"},home_phone:{type:"tel"},work_phone:{type:"tel"},email1:{type:"email"},email2:{type:"email"},email3:{type:"email"}},{name:"address",className:"grid grid-cols-2 gap-2",address_line_1:{type:"text"},address_line_2:{type:"text"},region:{type:"text"},town:{type:"text"},county:{type:"text"},city:{type:"text"},postcode:{type:"text"},country:{type:"text",default:"United Kingdom"},fax:{type:"tel"}},{name:"extras",className:"",company:{type:"text"},web_page:{type:"text"},status:{type:"select",options:["ACTIVE","ARCHIVED"]},note:{type:"textarea",height:"140px"}},{name:"timestamps",className:"",created_at:{type:"timestamp",readonly:!0},updated_at:{type:"timestamp",readonly:!0}}],buttonsWrapper:"flex justify-end gap-2",buttons:{view:[{class:"btn-action bg-emerald-600 hover:bg-emerald-700 text-white",label:"Edit",action:"edit",icon:fe},{class:"btn-action bg-blue-500 text-white hover:bg-blue-400",label:"Orders",action:"viewOrders",icon:oe}],edit:[{class:"btn-action bg-blue-500 text-white hover:bg-blue-400",label:"Orders",action:"viewOrders",icon:oe},{class:"btn-action bg-emerald-600 hover:bg-emerald-700 text-white",label:"New Order",action:"newOrder",icon:ae},{class:"btn-action bg-yellow-500  text-gray-800 hover:bg-yellow-400 hover:text-gray-700",label:"Save",action:"save",icon:se}],add:[{class:"btn-action bg-emerald-600 hover:bg-emerald-700 text-white",label:"Add",action:"add",icon:ae},{class:"btn-action bg-rose-500 hover:bg-rose-600 text-white",label:"Cancel",action:"cancel",icon:se}]}},Ve={fields:{width:{type:"text",format:""},thickness:{type:"number"},length:{type:"number"},type:{type:"select",options:["Plank","Chevron","Herringbone","Versailles Panel","Mansion Weave"],filters:["startCase"]},price:{type:"number"}}},Ce={fields:{note:{type:"textarea"},web_page:{type:"text"},company:{type:"text"},grand_design:{type:"checkbox"}}},Ne={fields:{street:{type:"text"},town:{type:"text"},county:{type:"text"},city:{type:"text"},postcode:{type:"text"},country:{type:"text"}}},B={fields:{name:{type:"text"},price:{type:"number"}}},Oe={fields:{name:{type:"text"},value:{type:"text"}}},Se={className:"grid md:grid-cols-2 gap-3",columns:{id:["id"],name:["username"],role:["role.name"]},fields:{name:{type:"text"},username:{type:"text"},title:{type:"text"},email:{type:"text"},role:{type:"select",options:["admin","user"]},phone:{type:"text"},password:{type:"password"},mobile:{type:"text"},created_at:{type:"text",hide:!0},updated_at:{type:"text",hide:!0}}},X={fields:{name:{type:"text"}}},ke={areas:{...X},companies:he,contacts:we,customers:_e,dimensions:Ve,extras:B,floors:B,grades:B,materials:{...B,measurement_unit:{type:"text"}},notes:Ce,projects:Ne,services:{...B,measurement_unit:{type:"text"}},settings:Oe,statuses:{...X},users:Se},Ie=U=>ke[U]||X,ne=le({__name:"Item",props:{modelValue:{default:()=>({})},structure:{default:()=>({})},routeName:{default:""},mode:{default:"add"},class:{},enableTabs:{type:Boolean,default:!1}},emits:["update:modelValue","add","save","cancel","newOrder","viewOrders","update:tabs"],setup(U,{emit:b}){const i=b,p=re(),o=U,V=m(()=>!!o.structure.groups),z=Object.freeze({ADMIN:1,USER:2}),F=s=>{var g;if(s==="role")return((g=o.modelValue.role)==null?void 0:g.name)??"";const d=o.modelValue[s];return d!=null?String(d):""},O=(s,d,g)=>{if(d==="role"){const w=z[s.toString().toUpperCase()];if(w!==void 0){o.modelValue.role_id=w;const S=p.state.auth.roles.find(u=>u.id===w);o.modelValue.role=S,i("update:modelValue",o.modelValue);return}console.warn(`Invalid role: ${s}`);return}o.modelValue[d]=g.type==="number"?Number(s):s,i("update:modelValue",o.modelValue)},l=m(()=>o.structure),r=D({...l.value.tabs}),h=D(Object.keys(r.value).find(s=>r.value[s])),T=l.value.buttons??void 0,C=l.value.buttonsWrapper??"",v=m(()=>{if(!V.value)return{fields:l.value.fields,className:""};const s=l.value.groups.find(S=>S.name===h.value),{name:d,className:g,...w}=s;return{fields:w,className:g}}),P=m(()=>V.value?v.value.className:l.value.className),K=s=>{l.value.tabs[s]=!0},R=()=>i("cancel"),G=()=>i("add",o.modelValue),Y=()=>i("save",o.modelValue),H=()=>i("newOrder",o.modelValue),Z=()=>i("viewOrders",o.modelValue);return(s,d)=>{const g=_("active-tabs"),w=_("edit-row"),S=_("action-buttons");return n(),x(M,null,[s.enableTabs&&l.value.tabs?(n(),I(g,{key:0,"onUpdate:active":d[0]||(d[0]=u=>h.value=u),tabs:r.value,"onUpdate:tabs":d[1]||(d[1]=u=>K(u))},null,8,["tabs"])):A("",!0),c("div",{class:"fields-wrap overflow-auto my-4",style:ue({height:l.value.height})},[c("div",{class:E(P.value)},[(n(!0),x(M,null,W(v.value.fields,(u,$)=>(n(),x(M,{key:$},[u.hide?A("",!0):(n(),I(w,{key:0,class:E(u.class),modelValue:F($),"onUpdate:modelValue":L=>O(L,$,u),height:u.height,label:$,"label-on":!0,type:u.type,edit:!0,params:u},null,8,["class","modelValue","onUpdate:modelValue","height","label","type","params"]))],64))),128))],2)],4),j(S,{mode:s.mode,buttons:y(T),class:E(y(C)),onNewOrder:H,onViewOrders:Z,onAdd:G,onSave:Y,onCancel:R},null,8,["mode","buttons","class"])],64)}}}),Ae={class:"table-wrap"},$e={class:"px-4 overflow-auto w-full"},je={class:"bg-white"},De=["onClick"],Me=["data-label","innerHTML"],Te={class:"t-col t-col-action content-center","data-label":"Action"},Be={key:0},He=le({__name:"Items",setup(U){const b=re(),i=me(),p=ve(),{showNewItemModal:o,edit:V,pageSwitch:z,fetchData:F}=xe(),O=D(!1),l=m(()=>b.state.items[p.name].items),r=D({}),h=D({}),T=D({}),C=m(()=>b.state.pagination),v=m(()=>Ie(p.name)),P=m(()=>v.value.buttons),K=m(()=>Object.entries(T.value).map(([t,e])=>`${t},${e}`).join(";")),R=m(()=>v.value.columns),G=m(()=>{const t=v.value.columns;return t?l.value.map(k=>ge(k,t)):l.value}),Y=t=>{var q;const e=((q=v.value.sort)==null?void 0:q[t])??t,k=T.value[e]||"asc";T.value={[e]:k==="asc"?"desc":"asc"}},H=m(()=>R.value?Object.keys(R.value):Object.keys(v.value.fields)),Z=()=>{s(),o.value=!0},s=()=>{r.value={},h.value={}},d=(t,e)=>e==="measurement_unit"?t.measurement_unit:e==="price"?be(t.price):t[e],g=t=>{r.value={...t},h.value={...t},O.value=!0},w=async()=>{await b.dispatch("deleteItemAction",{id:r.value.id,routeName:p.name}),O.value=!1,s()},S=async()=>{await b.dispatch("createItemAction",{item:r.value,routeName:p.name}),r.value={},o.value=!1},u=t=>{V.value=!0;const e=l.value.find(k=>k.id===Number(t));r.value={...e},h.value={...e}},$=async()=>{await b.dispatch("updateItemAction",{item:r.value,itemClone:h.value,routeName:p.name}),V.value=!1,s()},L=t=>{i.push({name:"orders",query:{filters:{customer:t.id}}})},ie=async()=>{const{data:t}=await b.dispatch("orderCreate",{customer_id:r.value.id});i.push({name:"orderDetails",params:{id:t.id}})};return ee(K,t=>{const e={...p.query,orderBy:t||void 0};p.query.orderBy===t?i.replace({query:{...e,_ts:Date.now()}}):i.replace({query:e})}),ee(p,()=>{F()},{immediate:!0}),(t,e)=>{const k=_("base-button"),q=_("items-options"),J=_("modal"),de=_("action-buttons"),ce=_("pagination"),pe=_("main-layout");return n(),I(pe,null,{options:N(()=>[j(k,{class:"btn-action bg-emerald-600 hover:bg-emerald-700 text-white",onClick:Z},{default:N(()=>e[8]||(e[8]=[c("svg",{xmlns:"http://www.w3.org/2000/svg",width:"18",height:"18",viewBox:"0 0 24 24"},[c("path",{fill:"currentColor",d:"M13 4v7h7v2h-7v7h-2v-7H4v-2h7V4h2Z"})],-1)])),_:1}),j(q)]),default:N(()=>[O.value?(n(),I(J,{key:0,controls:!0,class:"send",onClose:e[0]||(e[0]=a=>O.value=!1),onNo:e[1]||(e[1]=a=>O.value=!1),onYes:w},{default:N(()=>e[9]||(e[9]=[Q(" Do you wish to delete this user? ")])),_:1})):A("",!0),y(o)?(n(),I(J,{key:1,onClose:e[4]||(e[4]=a=>o.value=!1)},{title:N(()=>e[10]||(e[10]=[Q("Add Item")])),default:N(()=>[j(ne,{modelValue:r.value,"onUpdate:modelValue":e[2]||(e[2]=a=>r.value=a),mode:"add",routeName:y(p).name,structure:v.value,enableTabs:!0,onAdd:S,onCancel:e[3]||(e[3]=a=>o.value=!1)},null,8,["modelValue","routeName","structure"])]),_:1})):A("",!0),y(V)?(n(),I(J,{key:2,onClose:e[7]||(e[7]=a=>V.value=!1),style:ue({height:v.value.modalMinHeight})},{title:N(()=>e[11]||(e[11]=[Q("Edit Item")])),default:N(()=>[j(ne,{mode:"edit",modelValue:h.value,"onUpdate:modelValue":e[5]||(e[5]=a=>h.value=a),routeName:y(p).name,structure:v.value,enableTabs:!0,onNewOrder:ie,onViewOrders:L,onSave:$,onCancel:e[6]||(e[6]=a=>V.value=!1)},null,8,["modelValue","routeName","structure"])]),_:1},8,["style"])):A("",!0),c("div",Ae,[c("div",$e,[c("table",null,[c("thead",null,[c("tr",je,[(n(!0),x(M,null,W(H.value,a=>(n(),x("th",{key:a,scope:"col",class:E(`t-col t-col-${a.toLowerCase()}`),onClick:f=>Y(a)},ye(y(te)(a)),11,De))),128)),e[12]||(e[12]=c("th",{scope:"col",class:"t-col t-col-action"}," Action ",-1))])]),c("tbody",null,[(n(!0),x(M,null,W(G.value,a=>(n(),x("tr",{key:a.id},[(n(!0),x(M,null,W(H.value,f=>(n(),x("td",{class:E(["t-col",`t-col-${f.toLowerCase()}`]),"data-label":y(te)(f),key:f,innerHTML:d(a,f)},null,10,Me))),128)),c("td",Te,[j(de,{buttons:P.value,mode:"view",onEdit:f=>u(a.id),onRemove:f=>g(a),onViewOrders:f=>L(a),onOrderCreate:async()=>{const{data:f}=await y(b).dispatch("orderCreate",{customer_id:a.id});y(i).push({name:"orderDetails",params:{id:f.id}})},class:"flex justify-end gap-2"},null,8,["buttons","onEdit","onRemove","onViewOrders","onOrderCreate"])])]))),128)),l.value.length?A("",!0):(n(),x("tr",Be,e[13]||(e[13]=[c("td",{colspan:"10",class:"text-center text-capitalize text-uppercase font-bold"}," Sorry No Records Found ",-1)])))])]),C.value.last_page&&C.value.current_page?(n(),I(ce,{key:C.value.current_page+"-"+C.value.last_page,class:"w-full justify-end py-2 bg-neutral-100 border-t-2","click-handler":y(z),"per-slice":5,"current-page":C.value.current_page,"last-page":C.value.last_page},null,8,["click-handler","current-page","last-page"])):A("",!0)])])]),_:1})}}});export{He as default};
